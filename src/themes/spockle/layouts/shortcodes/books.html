<style>
    .project-grid li a img {
        aspect-ratio: initial !important;
    }
</style>

{{ $id := .Get "shelve" }} 
{{ $shelve := getJSON "https://api.geheimesite.nl/books/get.php?id=" $id }} 

{{ if $shelve.items }} 

{{ $all := getJSON "https://api.geheimesite.nl/books/get.php?id=5568" }}
{{ $total_books := (add (len $all.items)  30)}} 

{{ with .Get "title" }}
    <h2>{{ . }}</h2>
{{ end }} 

{{ with .Get "description" }}
    <p>{{ replace . "{count}" $total_books | markdownify }}</p>
{{ end }}

<ul class="book-grid">
    {{ range $shelve.items }}
        {{ $title := .title }}
        {{ $id := .id }}

        <li>
            <h3>{{ $title }}</h3>

            <a href="{{ .url }}">

                {{ with resources.GetRemote .image }}

                    {{ $image := .Content | resources.FromString (printf "assets/images/books/%f.webp" $id) }}
                    {{ with $image.Fill "550x800 webp"  }}

                        <img
                            src="{{ .RelPermalink }}"
                            alt="{{ $title }}" />
                    
                    {{ end }}

                {{ else }}

                    {{ with resources.Get "assets/images/books/missing.jpg"  }}

                        {{ with .Resize (printf "%dx%d webp" .Width .Height) }}

                            <img
                                src="{{ .RelPermalink }}"
                                alt="{{ $title }}" />

                        {{ end }}

                    {{ end }}

                {{ end }}
            </a>
        </li>
    {{ end }}
</ul>
{{ end}}
